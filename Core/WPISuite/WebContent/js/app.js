// Generated by CoffeeScript 1.7.1
(function() {
  $(function() {
    var attr;
    window.App = Ember.Application.create();
    App.ApplicationAdapter = DS.FixtureAdapter.extend({
      queryFixtures: function(fixtures, query, type) {
        return fixtures.filter(function(item) {
          var prop, _i, _len;
          for (_i = 0, _len = query.length; _i < _len; _i++) {
            prop = query[_i];
            if (item[prop] !== query[prop]) {
              false;
            }
          }
          return true;
        });
      }
    });
    App.Store = DS.Store.extend({
      adapter: DS.FixtureAdapter
    });
    App.ApplicationAdapter.registerTransform('raw', {
      deserialize: function(serialized) {
        return serialized;
      },
      serialize: function(deserialized) {
        return deserialized;
      }
    });
    attr = DS.attr;
    App.Session = DS.Model.extend({
      name: attr('string'),
      endDate: attr('date'),
      sessionCreatorName: attr('string'),
      description: attr('string'),
      uuid: attr('string'),
      gameState: attr('string'),
      requirementIDs: attr('raw'),
      isUsingDeck: attr('boolean'),
      estimates: attr('raw')
    });
    App.Requirement = DS.Model.extend({
      name: attr('string'),
      description: attr('string')
    });
    $.ajax({
      dataType: 'json',
      url: 'API/planningpoker/planningpokersession',
      async: false,
      success: (function(_this) {
        return function(data) {
          var session, _i, _len;
          for (_i = 0, _len = data.length; _i < _len; _i++) {
            session = data[_i];
            session['id'] = session['uuid'];
          }
          return App.Session.FIXTURES = data;
        };
      })(this)
    });
    $.ajax({
      dataType: 'json',
      url: 'API/requirementmanager/requirement',
      async: false,
      success: (function(_this) {
        return function(data) {
          return App.Requirement.FIXTURES = data;
        };
      })(this)
    });
    App.Router.map(function() {
      return this.resource('sessions', {
        path: '/'
      }, function() {
        return this.resource('session', {
          path: '/:session_uuid'
        });
      });
    });
    App.SessionsRoute = Ember.Route.extend({
      model: function() {
        return this.store.find('session');
      }
    });
    App.SessionRoute = Ember.Route.extend({
      serialize: function(session) {
        return {
          session_uuid: session.get('uuid')
        };
      },
      model: function(params) {
        return this.store.find('session', {
          uuid: params.session_uuid
        });
      }
    });
    App.SessionController = Ember.ObjectController.extend({
      requirementByID: function(id) {
        return this.store.find('requirement', id);
      }
    });
    return Ember.Handlebars.helper('requirementName', function(requirementID) {
      return App.Requirement.FIXTURES.findBy('id', requirementID)['name'];
    });
  });

}).call(this);
